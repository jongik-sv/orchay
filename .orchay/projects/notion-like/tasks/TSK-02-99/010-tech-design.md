# 010-tech-design.md

## Task 정보

| 항목 | 내용 |
|------|------|
| Task ID | TSK-02-99 |
| Task명 | WP-02 통합 검증 |
| Category | infrastructure |
| Domain | test |
| Priority | high |
| 의존성 | TSK-02-01, TSK-02-02, TSK-02-03, TSK-02-04, TSK-02-05, TSK-02-06, TSK-02-07 |

---

## 1. 목적

WP-02(페이지 구조 - 사이드바 + 네비게이션)의 모든 기능이 통합되어 정상적으로 동작하는지 검증한다. 사이드바, 페이지 트리, 페이지 CRUD, 라우팅, 즐겨찾기, 검색 기능이 에디터와 연동되어 완전한 사용자 경험을 제공하는지 확인한다.

---

## 2. 검증 범위

### 2.1 통합 대상 컴포넌트

| 컴포넌트 | Task ID | 상태 | 주요 기능 |
|----------|---------|------|----------|
| MainLayout | TSK-02-01 | [vf] | 사이드바 + 에디터 2컬럼 레이아웃, 토글 |
| Sidebar | TSK-02-02 | [vf] | 워크스페이스 헤더, 퀵 액션, 페이지 트리 영역 |
| PageTree | TSK-02-03 | [vf] | 재귀적 트리 렌더링, 폴더 열기/닫기 |
| 페이지 CRUD | TSK-02-04 | [vf] | 생성/삭제/이동, API 연동 |
| 라우팅 | TSK-02-05 | [vf] | 동적 라우트, URL 연동 |
| 즐겨찾기 | TSK-02-06 | [vf] | 토글, Favorites 섹션 |
| 검색 | TSK-02-07 | [dd] | Cmd+K 모달, 제목 검색 |

### 2.2 연동 확인 대상

- **WP-01 에디터**: 페이지 로드 시 에디터 콘텐츠 정상 표시
- **Zustand 스토어**: 상태 변경 시 UI 즉시 반영
- **SQLite DB**: 데이터 영속성 보장

---

## 3. 테스트 시나리오

### 3.1 페이지 생성 → 사이드바 → 에디터 연동

```
1. 새 페이지 생성 (+버튼 클릭)
2. 사이드바에 새 페이지 즉시 표시 확인
3. 새 페이지 클릭 시 에디터 로드
4. 에디터에서 제목/콘텐츠 편집
5. 자동 저장 후 새로고침
6. 데이터 유지 확인
```

**수용 기준**:
- 페이지 생성 후 1초 내 사이드바 반영
- 에디터 로드 시 빈 문서 또는 기본 블록 표시
- 저장된 콘텐츠 새로고침 후 유지

### 3.2 하위 페이지 생성 → 트리 구조 확인

```
1. 기존 페이지 우클릭 → "하위 페이지 추가"
2. 하위 페이지 생성 확인
3. 부모 페이지 토글로 접기/펼치기
4. 들여쓰기 정상 표시 확인
5. 하위 페이지 클릭 → 에디터 로드
```

**수용 기준**:
- 부모-자식 관계 정상 설정 (parent_id)
- depth에 따른 들여쓰기 (depth * 12 + 8 px)
- 토글 상태 유지

### 3.3 즐겨찾기 기능

```
1. 페이지 호버 → 별 아이콘 표시
2. 별 클릭 → 즐겨찾기 추가
3. Favorites 섹션에 페이지 표시 확인
4. 다시 별 클릭 → 즐겨찾기 제거
5. Favorites 섹션에서 제거 확인
```

**수용 기준**:
- 즐겨찾기 상태 DB 저장 (is_favorite)
- Favorites 섹션 실시간 업데이트
- 페이지 트리에서도 별 아이콘 상태 반영

### 3.4 검색 기능 (Cmd+K)

```
1. Cmd+K (또는 Ctrl+K) 입력
2. 검색 모달 표시 확인
3. 페이지 제목 입력
4. 실시간 필터링 결과 표시
5. 결과 클릭 → 해당 페이지 이동
6. ESC로 모달 닫기
```

**수용 기준**:
- 단축키로 모달 열기/닫기
- 타이핑 시 즉시 필터링 (debounce 적용)
- 결과 클릭 시 URL 변경 및 에디터 로드

### 3.5 URL 직접 입력

```
1. 브라우저 URL에 /[pageId] 직접 입력
2. 해당 페이지 정상 로드 확인
3. 존재하지 않는 pageId 입력
4. 404 또는 에러 페이지 표시 확인
```

**수용 기준**:
- 유효한 pageId → 페이지 로드
- 무효한 pageId → 에러 처리 (404 또는 리다이렉트)

---

## 4. 기술 검증 항목

### 4.1 API 통합

| API | Method | 검증 항목 |
|-----|--------|----------|
| /api/pages | GET | 전체 페이지 목록 조회, 트리 구조 반환 |
| /api/pages | POST | 새 페이지 생성, parentId 옵션 |
| /api/pages/:id | GET | 단일 페이지 조회 |
| /api/pages/:id | PUT | 제목/콘텐츠/즐겨찾기 업데이트 |
| /api/pages/:id | DELETE | 페이지 삭제, cascade 확인 |

### 4.2 상태 관리 동기화

- 페이지 생성/삭제 시 Zustand 스토어 업데이트
- URL 변경 시 currentPageId 동기화
- 사이드바 열림/닫힘 상태 유지

### 4.3 에러 핸들링

- 네트워크 에러 시 사용자 알림
- DB 에러 시 롤백 처리
- 동시 편집 충돌 방지 (낙관적 업데이트)

---

## 5. 성능 기준

| 항목 | 목표 |
|------|------|
| 페이지 목록 로드 | < 500ms (100개 기준) |
| 페이지 전환 | < 200ms |
| 검색 응답 | < 100ms (50개 기준) |
| 자동 저장 | debounce 1초 |

---

## 6. 테스트 환경

- **브라우저**: Chrome/Edge 최신 버전
- **해상도**: 1920x1080 (데스크톱), 768x1024 (태블릿)
- **데이터**: 최소 10개 페이지, 3단계 중첩

---

## 7. 완료 조건

- [ ] 모든 테스트 시나리오 통과
- [ ] API 통합 검증 완료
- [ ] 상태 동기화 검증 완료
- [ ] 에러 핸들링 검증 완료
- [ ] 성능 기준 충족

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0 | 2026-01-03 | 초기 작성 |
