# TSK-03-99 - WP-03 및 전체 MVP 통합 검증 설계 문서

## 문서 정보

| 항목 | 내용 |
|------|------|
| Task ID | TSK-03-99 |
| Task Title | WP-03 및 전체 MVP 통합 검증 |
| 문서 버전 | 1.0 |
| 작성일 | 2026-01-02 |
| 상태 | 작성중 |
| 카테고리 | simple-dev (통합 검증) |
| 도메인 | test |

---

## 1. 개요

### 1.1 배경 및 문제 정의

Orchay Notes는 Notion과 유사한 블록 기반 올인원 워크스페이스 애플리케이션의 MVP 개발을 진행 중입니다. 현재까지 다음 WP가 완성되었습니다:

**현재 상황:**
- WP-00: 프로젝트 초기화 (완료)
- WP-01: 핵심 에디터 (완료)
- WP-02: 페이지 구조 (완료)
- WP-03: MVP 완성 및 마무리 (진행 중)

각 WP의 개별 기능은 정상 동작하지만, 모든 기능이 통합되어 실제 사용자 시나리오에서 원활하게 작동하는지 검증이 필요합니다.

**해결하려는 문제:**
- 개별 기능들이 서로 정상적으로 연동되지 않을 수 있음
- 성능, 메모리, UI/UX 이슈가 실제 사용 환경에서 발생할 수 있음
- 모바일, 다크모드 등 추가 기능의 안정성 검증 필요

### 1.2 목적 및 기대 효과

**목적:**
- MVP 전체 기능의 통합 검증
- 사용자 시나리오 기반 E2E 테스트
- 성능, 호환성, 안정성 확인

**기대 효과:**
- MVP 품질 보증
- 본격 출시 전 미처 발견하지 못한 버그 제거
- 사용자 경험 검증

### 1.3 범위

**포함:**
- WP-00, WP-01, WP-02, WP-03 통합 테스트
- 다음 사용자 시나리오 E2E 검증:
  1. 프로젝트 시작 → 첫 페이지 생성 → 제목/아이콘/커버 설정 → 콘텐츠 작성 → 저장
  2. 하위 페이지 생성 → 계층 구조 표시 → 토글 펼치기/접기
  3. 즐겨찾기 추가 → Favorites 섹션 표시
  4. Cmd+K 검색 → 결과 클릭 → 페이지 이동
  5. URL 직접 입력 → 해당 페이지 로드
  6. 다크모드 전환 → UI 정상 표시
  7. 모바일 뷰 → 사이드바 토글 → 에디터 사용
  8. 새로고침 → 모든 데이터 유지

- 성능 테스트: 초기 로딩 시간, 페이지 전환 속도
- 호환성: 주요 브라우저 (Chrome, Firefox, Safari, Edge)
- 반응형: 데스크톱, 태블릿, 모바일
- 에러 처리: API 실패, 네트워크 오류, 권한 오류

**제외:**
- 성능 최적화 (별도 task)
- 추가 기능 구현 (beyond MVP)
- 무한 스크롤, 고급 검색 필터

### 1.4 참조 문서

| 문서 | 경로 | 관련 섹션 |
|------|------|----------|
| PRD | `.orchay/projects/notion-like/prd.md` | 전체 MVP 요구사항 |
| TRD | `.orchay/projects/notion-like/trd.md` | 기술 스택, 구조 |
| WBS | `wbs.yaml` | WP-00~03 Task 정의 |

---

## 2. 검증 전략

### 2.1 검증 범위

**1단계: 기능 연동 검증**
- 개별 컴포넌트들의 상호 작용 확인
- API 호출 및 데이터 흐름 검증
- 상태 관리(Zustand) 동작 확인

**2단계: E2E 사용자 시나리오 테스트**
- 8개 주요 사용자 시나리오 실행
- 각 단계별 예상 결과 대비 실제 결과 비교
- 에러 발생 시 원인 분석 및 로깅

**3단계: 환경 및 호환성 테스트**
- 브라우저 호환성 (Chrome, Firefox, Safari, Edge)
- 반응형 (데스크톱 1920px, 태블릿 768px, 모바일 375px)
- 다크모드 전환 정상 동작

**4단계: 성능 기준선 설정**
- 초기 로딩 시간 (목표: < 3초)
- 페이지 전환 (목표: < 500ms)
- 에디터 입력 반응성 (목표: <100ms 입력 지연)

### 2.2 검증 방법론

**Playwright E2E 자동화:**
- 주요 사용자 시나리오를 Playwright 테스트로 자동화
- CI/CD 파이프라인에서 매번 실행
- 스크린샷 비교, 성능 메트릭 수집

**수동 테스트:**
- UI 미세한 부분 (호버 상태, 애니메이션)
- 사용성 (직관성, 접근성)
- 예외 상황 (네트워크 끊김, 창 크기 변경)

**자동화 테스트:**
- 단위 테스트 (컴포넌트 단위)
- 통합 테스트 (API+DB+UI)

---

## 3. 테스트 시나리오

### 3.1 시나리오 1: 초기 프로젝트 시작 (Happy Path)

**목적:** 신규 사용자의 가장 기본적인 사용 흐름 검증

**사전 조건:**
- 애플리케이션이 npm run dev로 정상 실행 중
- SQLite DB 초기화 완료 (TSK-00-04)
- 기본 레이아웃 로드 완료 (TSK-02-01)

**단계별 진행:**

| 단계 | 사용자 행동 | 시스템 반응 | 예상 결과 | 검증 포인트 |
|------|-----------|------------|----------|-----------|
| 1 | localhost:3000 접속 | 페이지 로드 | 메인 레이아웃 (사이드바+에디터) 표시 | 로딩 시간 < 3초 |
| 2 | 사이드바 "새 페이지" 버튼 클릭 | 새 페이지 생성 | 기본 페이지명 "Untitled"로 새 페이지 생성, 사이드바에 표시 | API POST /api/pages 성공 |
| 3 | 생성된 페이지 클릭 | 페이지 로드 | 에디터 영역에 해당 페이지 내용 표시 | URL이 /[pageId]로 변경 |
| 4 | 페이지 제목 입력 | 제목 편집 | 입력한 제목으로 변경, DB 저장 | 데이터 저장 완료 메시지 |
| 5 | 페이지 아이콘 영역 클릭 | 이모지 피커 오픈 | 이모지 선택 모달 표시 | 모달 외부 클릭 시 닫힘 |
| 6 | 이모지 선택 | 아이콘 변경 | 선택한 이모지로 페이지 아이콘 변경 | UI 즉시 반영 |
| 7 | 에디터 영역 클릭 | 에디터 활성화 | 커서 표시, 입력 가능 상태 | 텍스트 입력 가능 |
| 8 | 텍스트 입력 | 블록 생성 | 입력 내용이 기본 텍스트 블록으로 생성 | 자동 저장 (debounce 1초) |
| 9 | 페이지 새로고침 (F5) | 페이지 재로드 | 이전에 작성한 제목, 아이콘, 내용 모두 유지 | DB에서 정상 로드 |
| 10 | 페이지 삭제 (우클릭 메뉴) | 삭제 확인 모달 | "이 페이지를 삭제하시겠습니까?" 메시지 표시 | 취소 버튼 클릭 시 삭제 안 됨 |
| 11 | 삭제 확인 | 페이지 삭제 | 사이드바에서 해당 페이지 제거, DB에서 삭제 | API DELETE /api/pages/:id 성공 |

**성공 조건:**
- 모든 단계 완료
- 데이터 일관성 유지 (새로고침 후에도 동일)
- 에러 메시지 없음

---

### 3.2 시나리오 2: 계층적 페이지 구조

**목적:** 중첩 페이지 생성, 트리 구조 표시, 폴더 토글 기능 검증

**사전 조건:**
- 시나리오 1 완료
- 페이지 트리 컴포넌트 정상 작동 (TSK-02-03)

**단계별 진행:**

| 단계 | 사용자 행동 | 시스템 반응 | 예상 결과 |
|------|-----------|------------|----------|
| 1 | 기존 페이지 우클릭 | 컨텍스트 메뉴 | "하위 페이지 추가" 옵션 표시 |
| 2 | "하위 페이지 추가" 클릭 | 하위 페이지 생성 | 부모 페이지 아래에 들여쓰기된 하위 페이지 표시 |
| 3 | 하위 페이지에 제목/내용 입력 | 데이터 저장 | 저장 완료, 사이드바 갱신 |
| 4 | 부모 페이지 앞 토글 아이콘 클릭 | 폴더 열기/닫기 | 하위 페이지 표시/숨김 |
| 5 | 하위 페이지 클릭 | 페이지 로드 | 에디터에 해당 페이지 내용 표시, URL 변경 |
| 6 | 하위 페이지 삭제 | 삭제 | 부모 페이지는 유지, 하위만 삭제 |
| 7 | 부모 페이지 삭제 | 삭제 확인 | "하위 페이지도 함께 삭제됩니다" 경고 표시 |

**성공 조건:**
- 트리 구조 정상 표시
- 들여쓰기 계산 정확 (depth * 12 + 8px)
- 부모-자식 관계 데이터 일관성

---

### 3.3 시나리오 3: 즐겨찾기 및 검색

**목적:** 즐겨찾기 기능, Cmd+K 검색 기능 검증

**사전 조건:**
- 여러 페이지 생성 (시나리오 1, 2)
- 검색 기능 구현 완료 (TSK-02-07)

**단계별 진행:**

| 단계 | 사용자 행동 | 시스템 반응 | 예상 결과 |
|------|-----------|------------|----------|
| 1 | 페이지 제목 앞 별 아이콘 클릭 | 즐겨찾기 토글 | 별 아이콘 채워짐, Favorites 섹션에 추가 |
| 2 | Favorites 섹션 확인 | UI 렌더링 | 즐겨찾기 추가된 페이지들만 표시 |
| 3 | 별 아이콘 재클릭 | 즐겨찾기 제거 | 별 아이콘 해제, Favorites에서 제거 |
| 4 | Cmd+K 단축키 입력 | 검색 모달 오픈 | 검색 입력창과 결과 영역 표시 |
| 5 | 검색어 "Untitled" 타이핑 | 실시간 필터링 | 해당 페이지명 포함된 결과 표시 |
| 6 | 검색 결과 클릭 | 페이지 이동 | 해당 페이지로 이동, URL 변경 |
| 7 | Esc 키 | 모달 닫기 | 검색 모달 닫힘 |

**성공 조건:**
- 즐겨찾기 상태 DB 저장 및 새로고침 후 유지
- 검색 결과 정확성
- 검색 모달 키보드 단축키 정상 작동

---

### 3.4 시나리오 4: URL 직접 접근

**목적:** 페이지 URL을 직접 입력했을 때 정상 로드 검증

**사전 조건:**
- 시나리오 1, 2 완료 (여러 페이지 생성)
- 동적 라우팅 구현 완료 (TSK-02-05)

**단계별 진행:**

| 단계 | 사용자 행동 | 시스템 반응 | 예상 결과 |
|------|-----------|------------|----------|
| 1 | 페이지 A 접속, URL 확인 | URL 표시 | `/[pageId]` 형식 |
| 2 | 새 탭에서 해당 URL 입력 | 페이지 로드 | 페이지 A 정상 로드, 제목/아이콘/내용 표시 |
| 3 | 잘못된 ID로 접근 (예: /invalid-id) | 에러 처리 | 404 페이지 또는 에러 메시지 표시 |
| 4 | 뒤로가기/앞으로가기 | 네비게이션 | 브라우저 히스토리 정상 작동 |

**성공 조건:**
- URL과 페이지 내용 일치
- 직접 접근 시에도 정상 로드
- 존재하지 않는 페이지 처리

---

### 3.5 시나리오 5: 다크모드 전환

**목적:** 다크모드 CSS 변수 적용, 시스템 설정 감지 검증

**사전 조건:**
- 다크모드 CSS 변수 정의 완료 (TSK-03-02)

**단계별 진행:**

| 단계 | 사용자 행동 | 시스템 반응 | 예상 결과 |
|------|-----------|------------|----------|
| 1 | 시스템 다크모드 활성화 | 감지 | 애플리케이션이 자동으로 다크모드 적용 |
| 2 | UI 색상 확인 | 렌더링 | 배경 #191919, 텍스트 #E6E6E4 등 정상 표시 |
| 3 | 사이드바, 에디터 등 모든 요소 | 색상 일관성 | 모든 UI 요소가 다크모드 적용됨 |
| 4 | 텍스트 입력 | 대비 확인 | 텍스트가 명확하게 보임 (WCAG AA 기준 만족) |
| 5 | 다크모드 해제 | 라이트모드 전환 | 원래 색상으로 복원 |

**성공 조건:**
- 색상 전환 부드럽게 (transition 적용)
- 모든 요소에 일관되게 적용
- 새로고침 후 설정 유지

---

### 3.6 시나리오 6: 모바일 반응형

**목적:** 모바일 화면에서 레이아웃 및 상호작용 검증

**사전 조건:**
- 반응형 레이아웃 적용 완료 (TSK-03-01)

**장치별 테스트:**

**데스크톱 (1920px):**
| 단계 | 동작 | 예상 결과 |
|------|------|----------|
| 1 | 페이지 로드 | 사이드바 240px 고정, 에디터 flex-1로 확장 |
| 2 | 사이드바 토글 | 사이드바 접기/펼치기 정상 작동 |

**태블릿 (768px):**
| 단계 | 동작 | 예상 결과 |
|------|------|----------|
| 1 | 페이지 로드 | 레이아웃 조정, 에디터 패딩 축소 |
| 2 | 사이드바 표시 | 여전히 표시되지만 너비 조정 |

**모바일 (375px):**
| 단계 | 동작 | 예상 결과 |
|------|------|----------|
| 1 | 페이지 로드 | 사이드바 오버레이 (absolute z-50) |
| 2 | 햄버거 메뉴 클릭 | 사이드바 토글 (오버레이 표시/숨김) |
| 3 | 에디터 패딩 | px-6 (24px) 적용, 콘텐츠 가독성 유지 |
| 4 | 페이지 편집 | 에디터 기능 정상 작동 |
| 5 | 검색 (Cmd+K) | 모바일에 적합한 검색 UI 표시 |

**성공 조건:**
- 모든 화면 크기에서 기능 정상 작동
- 터치 인터랙션 최적화 (버튼 크기 >= 48px)
- 가로/세로 모드 전환 시 레이아웃 정상 조정

---

### 3.7 시나리오 7: 에러 처리

**목적:** API 실패, 네트워크 오류, 데이터 일관성 문제 처리 검증

**단계별 진행:**

| 시나리오 | 상황 | 예상 동작 | 검증 |
|---------|------|----------|------|
| API 실패 | 페이지 저장 중 500 에러 | 토스트 알림 "저장 실패" | 재시도 가능 |
| 네트워크 끊김 | 요청 중 연결 끊김 | 타임아웃 후 에러 메시지 | "연결을 확인해주세요" |
| 권한 없음 | 다른 사용자 페이지 삭제 시도 | 403 에러 처리 | "권한이 없습니다" |
| 중복 생성 | 동일 이름 페이지 생성 | 경고 또는 자동 이름 변경 | "Page (1)", "Page (2)" |

**성공 조건:**
- 사용자가 에러 상황 이해 가능
- 복구 방법 제시 (재시도, 새로고침 등)
- 데이터 손상 없음

---

### 3.8 시나리오 8: 성능 기준선

**목적:** 주요 성능 메트릭 측정 및 기준선 설정

**측정 항목:**

| 항목 | 기준값 | 측정 방법 |
|------|--------|----------|
| 초기 로딩 시간 | < 3초 | Lighthouse, 브라우저 DevTools |
| 페이지 전환 | < 500ms | React DevTools Profiler |
| 에디터 입력 지연 | < 100ms | 사용자 체감도 + 타이밍 측정 |
| Lighthouse 점수 | Performance >= 80 | lighthouse-ci |

**성공 조건:**
- 모든 항목에서 기준값 달성
- 메모리 누수 없음 (Chrome DevTools Memory)
- CPU 사용률 정상 범위

---

## 4. 테스트 실행 계획

### 4.1 테스트 우선순위

**Priority 1 (필수):**
- 시나리오 1: 초기 프로젝트 시작
- 시나리오 2: 계층적 페이지 구조
- 시나리오 3: 즐겨찾기 및 검색
- 시나리오 4: URL 직접 접근

**Priority 2 (중요):**
- 시나리오 5: 다크모드
- 시나리오 6: 모바일 반응형
- 시나리오 7: 에러 처리

**Priority 3 (선택):**
- 시나리오 8: 성능 기준선

### 4.2 테스트 실행 환경

**브라우저:**
- Chrome 최신 버전
- Firefox 최신 버전
- Safari (macOS)
- Edge 최신 버전

**장치:**
- 데스크톱 (1920x1080, 1024x768)
- 태블릿 (768x1024)
- 모바일 (375x812)

**네트워크:**
- 빠른 연결 (실제 네트워크)
- 느린 연결 (DevTools Throttling)
- 오프라인 (에러 처리 검증)

### 4.3 테스트 자동화

**Playwright E2E 테스트:**
```typescript
// 주요 시나리오를 자동화하여 매 배포 시 실행
test('Scenario 1: Create and save page', async () => { ... });
test('Scenario 2: Nested page tree', async () => { ... });
test('Scenario 3: Search functionality', async () => { ... });
```

---

## 5. 검증 체크리스트

### 5.1 기능 검증

**에디터 및 페이지 저장:**
- [ ] 텍스트 입력 및 블록 생성 정상
- [ ] 자동 저장 (debounce 1초) 정상
- [ ] 새로고침 후 데이터 유지
- [ ] 페이지 제목/아이콘 편집 정상

**페이지 구조:**
- [ ] 신규 페이지 생성 정상
- [ ] 하위 페이지 생성 및 들여쓰기 정상
- [ ] 페이지 삭제 및 확인 모달 정상
- [ ] 페이지 트리 토글 정상

**네비게이션:**
- [ ] 페이지 클릭 시 URL 변경 정상
- [ ] URL 직접 입력 접근 정상
- [ ] 뒤로가기/앞으로가기 정상
- [ ] 존재하지 않는 페이지 처리 정상

**즐겨찾기 및 검색:**
- [ ] 별 아이콘 클릭 시 즐겨찾기 토글 정상
- [ ] Favorites 섹션 표시 정상
- [ ] Cmd+K 검색 모달 열기 정상
- [ ] 검색 실시간 필터링 정상
- [ ] 검색 결과 클릭 시 이동 정상

**다크모드:**
- [ ] 시스템 다크모드 감지 정상
- [ ] 모든 UI 요소에 색상 적용 정상
- [ ] 색상 전환 부드러움
- [ ] 새로고침 후 설정 유지

**반응형:**
- [ ] 데스크톱 레이아웃 정상
- [ ] 태블릿 레이아웃 조정 정상
- [ ] 모바일 사이드바 오버레이 정상
- [ ] 모바일 터치 인터랙션 정상

**에러 처리:**
- [ ] API 에러 시 토스트 알림 표시
- [ ] 네트워크 오류 메시지 명확
- [ ] 복구 방법 제시

### 5.2 성능 검증

- [ ] 초기 로딩 < 3초
- [ ] 페이지 전환 < 500ms
- [ ] 에디터 입력 지연 < 100ms
- [ ] Lighthouse Performance >= 80
- [ ] 메모리 누수 없음

### 5.3 호환성 검증

- [ ] Chrome 정상 작동
- [ ] Firefox 정상 작동
- [ ] Safari 정상 작동
- [ ] Edge 정상 작동

### 5.4 보안 및 데이터

- [ ] SQL Injection 취약성 없음
- [ ] XSS 취약성 없음
- [ ] CSRF 보호 적용
- [ ] 민감 데이터 노출 없음

---

## 6. 결과 기록

### 6.1 테스트 결과 요약

테스트 실행 후 다음 형식으로 결과 기록:

| 시나리오 | 상태 | 발견된 이슈 | 조치 |
|---------|------|-----------|------|
| 1: 초기 시작 | ✅/⚠️/❌ | (있으면 기술) | (수정 또는 defer) |
| 2: 계층 구조 | ✅/⚠️/❌ | | |
| 3: 검색 | ✅/⚠️/❌ | | |
| ... | | | |

### 6.2 버그 추적

발견된 버그는 별도 문서 `090-test-results.md`에 기록:
- 버그 ID
- 재현 방법
- 심각도 (Critical/High/Medium/Low)
- 우선순위

### 6.3 성능 메트릭

| 메트릭 | 측정값 | 목표값 | 상태 |
|--------|--------|--------|------|
| 초기 로딩 | Xs | <3s | ✅/⚠️ |
| 페이지 전환 | Xms | <500ms | ✅/⚠️ |
| Lighthouse | X | >=80 | ✅/⚠️ |

---

## 7. 완료 조건

MVP 통합 검증이 완료되려면 다음을 만족해야 합니다:

1. **모든 Priority 1 시나리오 통과 (✅)**
   - 시나리오 1~4 100% 완료

2. **Priority 2 시나리오 통과 (⚠️ 부분 허용)**
   - 반응형 레이아웃 주요 화면 검증
   - 다크모드 색상 일관성 검증

3. **Critical 버그 없음**
   - 데이터 손상, 보안 취약성 등

4. **성능 기준선 달성**
   - 초기 로딩 < 3초
   - Lighthouse >= 80

5. **기본 호환성 확보**
   - Chrome, Firefox, Safari, Edge 주요 기능 작동

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-02 | Claude | 최초 작성 |
