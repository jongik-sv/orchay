# 요구사항 추적성 매트릭스 (025-traceability-matrix.md)

**Template Version:** 1.0.0 — **Last Updated:** 2025-12-15

> **목적**: PRD → 기본설계 → 상세설계 → 테스트 4단계 양방향 추적
>
> **참조**: 이 문서는 `020-detail-design.md`와 `026-test-specification.md`와 함께 사용됩니다.

---

## 0. 문서 메타데이터

| 항목 | 내용 |
|------|------|
| Task ID | TSK-05-04 |
| Task명 | Document Viewer |
| 상세설계 참조 | `020-detail-design.md` |
| 테스트 명세 참조 | `026-test-specification.md` |
| 작성일 | 2025-12-15 |
| 작성자 | AI Agent |

---

## 1. 기능 요구사항 추적 (FR → 설계 → 테스트)

> PRD → 기본설계 → 상세설계 → 테스트케이스 매핑

| 요구사항 ID | PRD 섹션 | 기본설계 섹션 | 상세설계 섹션 | 단위 테스트 | E2E 테스트 | 매뉴얼 TC | 상태 |
|-------------|----------|--------------|--------------|-------------|------------|-----------|------|
| FR-001 | 8.1 | 2.1 | 7.2, 8.1, 12.2 | UT-001, UT-002 | E2E-001 | TC-001 | 설계완료 |
| FR-002 | TRD 2.2 | 2.1 | 12.4 | UT-003 | E2E-001 | TC-002 | 설계완료 |
| FR-003 | - | 2.1 | 12.3 | UT-004 | E2E-002 | TC-003 | 설계완료 |
| FR-004 | 8.1 | 2.1 | 7.2, 8.2 | UT-005 | E2E-003 | TC-004 | 설계완료 |
| FR-005 | 11 | 2.1 | 9.2 | UT-006 | E2E-004 | TC-005 | 설계완료 |
| FR-006 | 11 | 2.1 | 9.2, 11.1 | UT-007 | E2E-005 | TC-006 | 설계완료 |
| FR-007 | - | 2.1 | 9.2 | - | E2E-006 | TC-007 | 설계완료 |

### 1.1 요구사항별 상세 매핑

#### FR-001: Markdown → HTML 변환 및 렌더링

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| PRD | prd.md | 8.1 | API 명세 (문서 렌더링 요구사항) |
| 기본설계 | 010-basic-design.md | 2.1 | Markdown → HTML 변환 및 렌더링 |
| 상세설계 | 020-detail-design.md | 7.2, 8.1, 12.2 | marked 라이브러리 설정, useMarkdownRenderer Composable |
| 단위 테스트 | 026-test-specification.md | 2.1 | UT-001 (정상 렌더링), UT-002 (빈 내용) |
| E2E 테스트 | 026-test-specification.md | 3.1 | E2E-001 (문서 표시 확인) |

#### FR-002: 코드 블록 문법 하이라이팅 지원

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| PRD | trd.md | 2.2 | 코드 하이라이팅 요구사항 |
| 기본설계 | 010-basic-design.md | 2.1 | 코드 하이라이팅 설정 |
| 상세설계 | 020-detail-design.md | 12.4 | highlight.js 설정 (언어 팩, 테마) |
| 단위 테스트 | 026-test-specification.md | 2.1 | UT-003 (코드 블록 하이라이팅) |
| E2E 테스트 | 026-test-specification.md | 3.1 | E2E-001 (코드 블록 스타일 확인) |

#### FR-003: GFM 확장 구문 지원 (테이블, 체크박스, 취소선)

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| PRD | - | - | (기본설계에서 추가) |
| 기본설계 | 010-basic-design.md | 2.1 | GFM 확장 구문 지원 |
| 상세설계 | 020-detail-design.md | 12.3 | marked GFM 설정 |
| 단위 테스트 | 026-test-specification.md | 2.1 | UT-004 (테이블, 체크박스, 취소선) |
| E2E 테스트 | 026-test-specification.md | 3.1 | E2E-002 (GFM 렌더링 확인) |

#### FR-004: 문서 파일 API 로드

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| PRD | prd.md | 8.1 | API 명세 (문서 조회) |
| 기본설계 | 010-basic-design.md | 2.1 | API 연동 |
| 상세설계 | 020-detail-design.md | 7.2, 8.2 | GET /api/tasks/:id/documents/:filename, useDocumentLoader |
| 단위 테스트 | 026-test-specification.md | 2.1 | UT-005 (API 호출 성공/실패) |
| E2E 테스트 | 026-test-specification.md | 3.1 | E2E-003 (API 연동 확인) |

#### FR-005: 로딩 상태 표시 (Skeleton/Spinner)

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| PRD | prd.md | 11 | 로딩 상태 UI |
| 기본설계 | 010-basic-design.md | 2.1 | PrimeVue Skeleton |
| 상세설계 | 020-detail-design.md | 9.2 | 로딩 UI 레이아웃 |
| 단위 테스트 | 026-test-specification.md | 2.1 | UT-006 (로딩 상태 확인) |
| E2E 테스트 | 026-test-specification.md | 3.1 | E2E-004 (Skeleton 표시) |

#### FR-006: 에러 상태 표시

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| PRD | prd.md | 11 | 에러 상태 UI |
| 기본설계 | 010-basic-design.md | 2.1 | 에러 메시지 표시 |
| 상세설계 | 020-detail-design.md | 9.2, 11.1 | 에러 UI 레이아웃, 에러 처리 |
| 단위 테스트 | 026-test-specification.md | 2.1 | UT-007 (에러 상태 확인) |
| E2E 테스트 | 026-test-specification.md | 3.1 | E2E-005 (에러 메시지 표시) |

#### FR-007: 스크롤 가능한 컨텐츠 영역

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| PRD | - | - | (기본설계에서 추가) |
| 기본설계 | 010-basic-design.md | 2.1 | 스크롤 영역 |
| 상세설계 | 020-detail-design.md | 9.2 | maxHeight props, overflow-y: auto |
| 단위 테스트 | - | - | (CSS 테스트 제외) |
| E2E 테스트 | 026-test-specification.md | 3.1 | E2E-006 (스크롤 동작 확인) |

---

## 2. 비즈니스 규칙 추적 (BR → 구현 → 검증)

| 규칙 ID | PRD 출처 | 기본설계 섹션 | 구현 위치(개념) | 단위 테스트 | E2E 테스트 | 검증 방법 | 상태 |
|---------|----------|--------------|-----------------|-------------|------------|-----------|------|
| BR-001 | 8.1 | 6.1 | Server Route (파일명 검증) | UT-008 | E2E-007 | 정규식 `\d{3}-[\w-]+\.md` 검증 | 설계완료 |
| BR-002 | 보안 | 6.1 | Server Route (경로 탐색 방지) | UT-009 | E2E-008 | `filename.includes('..')` 거부 | 설계완료 |
| BR-003 | 보안 | 4.1 | useMarkdownRenderer (XSS 방지) | UT-010 | E2E-009 | DOMPurify sanitization 확인 | 설계완료 |
| BR-004 | 성능 | 6.1 | Server Route (파일 크기 제한) | UT-011 | E2E-010 | 1MB 초과 시 400 에러 | 설계완료 |

### 2.1 비즈니스 규칙별 상세 매핑

#### BR-001: 파일명 패턴 검증

| 구분 | 내용 |
|------|------|
| **PRD 원문** | 문서 파일명은 `{번호}-{이름}.md` 패턴 준수 |
| **기본설계 표현** | 파일명 형식: 3자리 숫자 + 하이픈 + 영문/숫자/하이픈 + .md |
| **구현 위치** | Server Route (GET /api/tasks/:id/documents/:filename) |
| **검증 방법** | 정규식: `/^\d{3}-[\w-]+\.md$/` 매칭 실패 시 400 에러 |
| **관련 테스트** | UT-008 (잘못된 파일명), E2E-007 (파일명 검증) |

#### BR-002: 경로 탐색 금지

| 구분 | 내용 |
|------|------|
| **PRD 원문** | 보안: 상위 디렉토리 접근 금지 |
| **기본설계 표현** | 파일명에 `../` 포함 불가 |
| **구현 위치** | Server Route (파일명 검증) |
| **검증 방법** | `filename.includes('..')` 검사, 포함 시 400 에러 |
| **관련 테스트** | UT-009 (경로 탐색 시도), E2E-008 (보안 검증) |

#### BR-003: XSS 방지

| 구분 | 내용 |
|------|------|
| **PRD 원문** | 보안: 악성 스크립트 삽입 방지 |
| **기본설계 표현** | v-html 사용 시 DOMPurify sanitization 필수 |
| **구현 위치** | useMarkdownRenderer Composable |
| **검증 방법** | DOMPurify.sanitize() 적용, `<script>` 태그 제거 확인 |
| **관련 테스트** | UT-010 (악성 HTML), E2E-009 (XSS 방지) |

#### BR-004: 파일 크기 제한

| 구분 | 내용 |
|------|------|
| **PRD 원문** | 성능: 대용량 파일 로드 방지 |
| **기본설계 표현** | 파일 크기 최대 1MB |
| **구현 위치** | Server Route (파일 크기 검증) |
| **검증 방법** | 파일 크기 > 1MB 시 400 에러 반환 |
| **관련 테스트** | UT-011 (대용량 파일), E2E-010 (파일 크기 검증) |

---

## 3. 테스트 역추적 매트릭스

> 테스트 결과 → 요구사항 역추적용 (build/verify 단계 결과서 생성 시 활용)

| 테스트 ID | 테스트 유형 | 검증 대상 요구사항 | 검증 대상 비즈니스 규칙 | 상태 |
|-----------|------------|-------------------|----------------------|------|
| UT-001 | 단위 | FR-001 | - | 미실행 |
| UT-002 | 단위 | FR-001 | - | 미실행 |
| UT-003 | 단위 | FR-002 | - | 미실행 |
| UT-004 | 단위 | FR-003 | - | 미실행 |
| UT-005 | 단위 | FR-004 | - | 미실행 |
| UT-006 | 단위 | FR-005 | - | 미실행 |
| UT-007 | 단위 | FR-006 | - | 미실행 |
| UT-008 | 단위 | - | BR-001 | 미실행 |
| UT-009 | 단위 | - | BR-002 | 미실행 |
| UT-010 | 단위 | - | BR-003 | 미실행 |
| UT-011 | 단위 | - | BR-004 | 미실행 |
| E2E-001 | E2E | FR-001, FR-002 | - | 미실행 |
| E2E-002 | E2E | FR-003 | - | 미실행 |
| E2E-003 | E2E | FR-004 | - | 미실행 |
| E2E-004 | E2E | FR-005 | - | 미실행 |
| E2E-005 | E2E | FR-006 | - | 미실행 |
| E2E-006 | E2E | FR-007 | - | 미실행 |
| E2E-007 | E2E | - | BR-001 | 미실행 |
| E2E-008 | E2E | - | BR-002 | 미실행 |
| E2E-009 | E2E | - | BR-003 | 미실행 |
| E2E-010 | E2E | - | BR-004 | 미실행 |
| TC-001 | 매뉴얼 | FR-001 | - | 미실행 |
| TC-002 | 매뉴얼 | FR-002 | - | 미실행 |
| TC-003 | 매뉴얼 | FR-003 | - | 미실행 |
| TC-004 | 매뉴얼 | FR-004 | - | 미실행 |
| TC-005 | 매뉴얼 | FR-005 | - | 미실행 |
| TC-006 | 매뉴얼 | FR-006 | - | 미실행 |
| TC-007 | 매뉴얼 | FR-007 | - | 미실행 |

---

## 4. 데이터 모델 추적

> 기본설계 엔티티 → 상세설계 타입 → API DTO 매핑

| 기본설계 엔티티 | 상세설계 타입 | API Request DTO | API Response DTO |
|----------------|---------------|-----------------|------------------|
| DocumentContent | DocumentContent | - | { content, filename, size, lastModified } |
| RenderedDocument | RenderedDocument | - | - |

---

## 5. 인터페이스 추적

> 기본설계 인터페이스 요구사항 → API 엔드포인트 매핑

| 기본설계 인터페이스 | 상세설계 API | Method | Endpoint | 요구사항 |
|--------------------|-------------|--------|----------|----------|
| 문서 조회 | Document API | GET | /api/tasks/:id/documents/:filename | FR-004 |

---

## 6. 화면 추적

> 기본설계 화면 요구사항 → 상세설계 컴포넌트 매핑

| 기본설계 화면 | 상세설계 화면 | 컴포넌트 | 요구사항 |
|--------------|--------------|----------|----------|
| 문서 뷰어 | DocumentViewer | DocumentViewer.vue | FR-001, FR-002, FR-003, FR-005, FR-006, FR-007 |

---

## 7. Composables 추적

> 기본설계 Composables 요구사항 → 상세설계 구현 매핑

| 기본설계 Composable | 상세설계 Composable | 역할 | 요구사항 |
|--------------------|---------------------|------|----------|
| useDocumentLoader | useDocumentLoader | API 호출, 캐싱, 에러 처리 | FR-004, FR-005, FR-006 |
| useMarkdownRenderer | useMarkdownRenderer | Markdown → HTML 변환, sanitization | FR-001, FR-002, FR-003 |

---

## 8. 추적성 검증 요약

### 8.1 커버리지 통계

| 구분 | 총 항목 | 매핑 완료 | 미매핑 | 커버리지 |
|------|---------|----------|--------|---------|
| 기능 요구사항 (FR) | 7 | 7 | 0 | 100% |
| 비즈니스 규칙 (BR) | 4 | 4 | 0 | 100% |
| 단위 테스트 (UT) | 11 | 11 | 0 | 100% |
| E2E 테스트 | 10 | 10 | 0 | 100% |
| 매뉴얼 테스트 (TC) | 7 | 7 | 0 | 100% |
| API 엔드포인트 | 1 | 1 | 0 | 100% |
| 컴포넌트 | 1 | 1 | 0 | 100% |
| Composables | 2 | 2 | 0 | 100% |

### 8.2 미매핑 항목 (있는 경우)

| 구분 | ID | 설명 | 미매핑 사유 |
|------|-----|------|-----------|
| - | - | - | - |

**검증 결과**: 모든 요구사항, 비즈니스 규칙, 테스트가 100% 매핑되었습니다.

---

## 관련 문서

- 상세설계: `020-detail-design.md`
- 테스트 명세: `026-test-specification.md`
- 기본설계: `010-basic-design.md`
- PRD: `.orchay/projects/orchay/prd.md`
- TRD: `.orchay/projects/orchay/trd.md`

---

<!--
author: AI Agent (Claude Opus 4.5)
Template Version: 1.0.0
Created: 2025-12-15
-->
